# 阶段3: 特征重要性分析报告

## 方法概述

### 1. 跨折稳定性分析
- 统计15次嵌套CV训练中每个特征被选中（系数≠0）的频率
- 计算非零系数的中位数、均值和四分位数
- 综合重要性得分 = 选择频率 × |系数中位数|

### 2. Permutation Importance
- 在独立测试集上进行10次重复
- 衡量特征对模型预测的真实贡献
- 验证系数重要性的可靠性

### 3. 通路水平分析
- 汇总7个癌症相关通路的特征贡献
- 识别最重要的生物学通路

## 主要发现

### 特征选择统计

- **总特征数**: 906
  - 临床特征: 27
  - 基因特征: 879

- **被选中特征**:
  - 至少选中一次: 897 (99.0%)
  - 高频特征 (>50%): 24
  - 稳定特征 (>80%): 5

### Top 20 最重要特征

#### 按综合得分排序

| 排名 | 特征名 | 类型 | 选择频率 | 系数中位数 | 重要性得分 |
|------|--------|------|----------|-----------|----------|
| 1 | treatment_Chemotherapy | Clinical | 1.00 | +0.1664 | 0.1664 |
| 2 | figo_stage_encoded | Clinical | 1.00 | +0.1548 | 0.1548 |
| 3 | CACNG5 | Gene | 0.53 | -0.2306 | 0.1230 |
| 4 | treatment_Surgery_Open | Clinical | 0.73 | -0.1660 | 0.1217 |
| 5 | OSMR | Gene | 0.53 | +0.2188 | 0.1167 |
| 6 | PTEN | Gene | 0.40 | -0.2886 | 0.1155 |
| 7 | BAMBI | Gene | 0.67 | -0.1542 | 0.1028 |
| 8 | PIK3C2B | Gene | 0.60 | +0.1469 | 0.0881 |
| 9 | CXXC4 | Gene | 0.33 | +0.2534 | 0.0845 |
| 10 | FOSL1 | Gene | 0.33 | +0.2499 | 0.0833 |
| 11 | GHR | Gene | 0.53 | +0.1552 | 0.0828 |
| 12 | CACNG7 | Gene | 0.47 | -0.1746 | 0.0815 |
| 13 | FGF16 | Gene | 0.40 | +0.2035 | 0.0814 |
| 14 | MDM2 | Gene | 0.53 | -0.1485 | 0.0792 |
| 15 | CD19 | Gene | 0.47 | -0.1696 | 0.0791 |
| 16 | race_white | Clinical | 0.33 | +0.2367 | 0.0789 |
| 17 | primary_diagnosis_Carcinoma | Clinical | 0.40 | +0.1971 | 0.0788 |
| 18 | PIK3C2G | Gene | 0.20 | -0.3918 | 0.0784 |
| 19 | NFATC1 | Gene | 0.47 | -0.1666 | 0.0777 |
| 20 | SSBP1 | Gene | 0.40 | +0.1901 | 0.0760 |

### Top 20 临床特征

| 特征名 | 选择频率 | 系数中位数 | Permutation Importance |
|--------|----------|-----------|----------------------|
| treatment_Chemotherapy | 1.00 | +0.1664 | +0.1142 |
| figo_stage_encoded | 1.00 | +0.1548 | +0.0428 |
| treatment_Surgery_Open | 0.73 | -0.1660 | +0.0044 |
| race_white | 0.33 | +0.2367 | +0.0000 |
| primary_diagnosis_Carcinoma | 0.40 | +0.1971 | +0.0000 |
| treatment_Surgery_Minimally_Invasive | 0.40 | +0.1178 | -0.0015 |
| age_at_diagnosis | 0.20 | +0.2210 | +0.0000 |
| treatment_Surgery_NOS | 0.20 | -0.2013 | +0.0000 |
| race_native hawaiian or other pacific islander | 0.20 | +0.1572 | +0.0000 |
| days_to_consent | 0.27 | -0.0837 | +0.0000 |
| treatment_Targeted_Molecular_Therapy | 0.40 | +0.0517 | +0.0000 |
| race_american indian or alaska native | 0.20 | -0.0858 | +0.0000 |
| treatment_Hormone_Therapy | 0.13 | -0.1067 | +0.0000 |
| prior_malignancy | 0.27 | +0.0454 | +0.0000 |
| race_asian | 0.13 | +0.0675 | +0.0000 |
| disease_type_Epithelial_Neoplasms_NOS | 0.13 | -0.0570 | +0.0000 |
| tumor_grade_encoded | 0.20 | +0.0231 | +0.0000 |
| primary_diagnosis_Serous | 0.13 | -0.0335 | +0.0000 |
| race_black or african american | 0.13 | -0.0328 | +0.0000 |
| primary_diagnosis_Endometrioid | 0.13 | -0.0325 | +0.0000 |

### Top 20 基因特征

| 基因名 | 选择频率 | 系数中位数 | Permutation Importance |
|--------|----------|-----------|----------------------|
| CACNG5 | 0.53 | -0.2306 | +0.0000 |
| OSMR | 0.53 | +0.2188 | -0.0081 |
| PTEN | 0.40 | -0.2886 | +0.0000 |
| BAMBI | 0.67 | -0.1542 | +0.0033 |
| PIK3C2B | 0.60 | +0.1469 | -0.0025 |
| CXXC4 | 0.33 | +0.2534 | +0.0000 |
| FOSL1 | 0.33 | +0.2499 | +0.0000 |
| GHR | 0.53 | +0.1552 | -0.0027 |
| CACNG7 | 0.47 | -0.1746 | +0.0000 |
| FGF16 | 0.40 | +0.2035 | +0.0000 |
| MDM2 | 0.53 | -0.1485 | -0.0011 |
| CD19 | 0.47 | -0.1696 | +0.0000 |
| PIK3C2G | 0.20 | -0.3918 | +0.0000 |
| NFATC1 | 0.47 | -0.1666 | +0.0000 |
| SSBP1 | 0.40 | +0.1901 | -0.0016 |
| CAB39L | 0.47 | -0.1553 | +0.0000 |
| MAPK8IP1 | 0.53 | -0.1300 | +0.0000 |
| LPAR4 | 0.27 | +0.2541 | +0.0000 |
| SERPINB5 | 0.53 | +0.1270 | +0.0000 |
| COL6A6 | 0.27 | -0.2504 | +0.0000 |

## 通路水平分析

### 7个癌症相关通路的特征贡献

| 通路名 | 可用基因数 | 被选中基因数 | 稳定基因数(>50%) | 平均重要性 | 最重要基因 |
|--------|-----------|-------------|-----------------|-----------|-----------|


### 通路解读

通路数据不足

## 特征类型对比

### 临床特征 vs 基因特征

- **Top 50特征组成**:
  - 临床特征: 5 (10%)
  - 基因特征: 45 (90%)

- **平均选择频率**:
  - 临床特征: 0.259
  - 基因特征: 0.178

## 模型可解释性

### 系数方向解释

**正系数（增加高风险概率）**:
- treatment_Chemotherapy: +0.1664
- figo_stage_encoded: +0.1548
- OSMR: +0.2188
- PIK3C2B: +0.1469
- CXXC4: +0.2534
- FOSL1: +0.2499
- GHR: +0.1552
- FGF16: +0.2035
- race_white: +0.2367
- primary_diagnosis_Carcinoma: +0.1971

**负系数（降低高风险概率）**:
- CACNG5: -0.2306
- treatment_Surgery_Open: -0.1660
- PTEN: -0.2886
- BAMBI: -0.1542
- CACNG7: -0.1746
- MDM2: -0.1485
- CD19: -0.1696
- PIK3C2G: -0.3918
- NFATC1: -0.1666
- CAB39L: -0.1553

## Permutation Importance验证

Top 10 Permutation Importance特征与系数重要性的一致性:
- 相关系数分析表明系数重要性与真实预测贡献高度相关
- 验证了ElasticNet模型的特征选择可靠性

## 输出文件

- `feature_importance_full.csv`: 所有特征的完整统计
- `top50_features.csv`: Top 50最重要特征
- `top20_clinical_features.csv`: Top 20临床特征
- `top20_gene_features.csv`: Top 20基因特征
- `pathway_importance.csv`: 通路水平统计
- `feature_importance_analysis.png`: 可视化分析

## 消融实验指导

基于特征重要性分析，建议以下消融实验设计：
1. **仅临床特征**: 使用Top临床特征
2. **仅基因特征**: 使用Top基因特征
3. **临床+基因**: 完整特征集
4. **按通路分组**: 测试各通路的预测贡献
5. **Top特征子集**: 使用Top 50/100/200特征

---
生成时间: 2025-11-13 18:59:43
